<!DOCTYPE html>
<html>
    <head>
        <title>DLinkedList</title>
    </head>
    <body>
        <h1>Double LinkedList</h1>
        <script>

                class Node {
                    constructor(element) {
                        this.element = element;
                        this.next = null
                        this.prev = null
                    }
                }
                // linkedlist class
                class DLinkedList {
                    constructor() {
                        this.head = null;
                        this.tail =null;
                        this.size = 0;
                    }
                
                   
                    add(element) {
                        var node = new Node(element);
                
                        if (this.head == null){
                            //document.write(node.prev) //empty LL
                            this.head = node;
                            this.tail=node;
                        }
                        else{
                            
                        this.tail.next=node
                        node.prev=this.tail
                        this.tail=node
                        }
                        
                        this.size++;
                    }
                    addAtBeginning(element){
                        let node=new Node(element)
                            node.next=this.head
                            this.head.prev=node
                            this.head=node
                        this.size++
                    }
                    addAtEnd(element){
                        let node=new Node(element)
                            this.tail.next=node
                            node.prev=this.tail
                            this.tail=node
                        this.size++    
                    }
                    insertAt(element, index) {
                        if (index < 0 || index > this.size)
                            return document.write("Please enter a valid index.");
                        else {
                            
                            var node = new Node(element);
                            var curr, prev;
                
                            curr = this.head;
                
                           
                            if (index == 0) {
                                node.next = this.head;
                                this.head.prev=node
                                this.head = node;
                            } else {
                                curr = this.head;
                                var it = 0;
                
                                
                                while (it < index) {
                                    it++;       //0 1 2
                                    prev = curr;//0 1
                                    curr = curr.next;// 1 2
                                }
                
                                // adding an element
                                curr.prev=node
                                node.next = curr;  // prev node curr
                               
                                node.prev=prev
                                prev.next = node;

                            }
                            this.size++;
                        }
                    }    
                    removeFrom(index) {
                        if (index < 0 || index >= this.size)
                            return document.write("Please Enter a valid index");
                        else {
                            var curr, prev, it = 0;
                            curr = this.head;
                            prev = curr;
                
                            // deleting first element
                            if (index === 0) {
                                curr.next.prev=null
                                this.head = curr.next;
                                curr.next=null
                                
                            } else {
                                // iterate over the list to the
                                // position to removce an element
                                while (it < index) {
                                    it++;
                                    prev = curr;
                                    curr = curr.next;
                                }
                
                                // remove the element
                                curr.next.prev=curr.prev
                                prev.next = curr.next; // prev XcurrX curr.next
                            }
                            this.size--;
                
                            // return the remove element
                            return curr.element;
                        }
                    }
                    search(element) {
                        var count = 0;
                        var current = this.head;
                
                        // iteraet over the list
                        while (current != null) {
                            // compare each element of the list
                            // with given element
                            if (current.element === element)
                                return count;
                            count++;
                            current = current.next;
                        }
                        // not found
                        return -1;
                    }
                    isEmpty() {
                        return this.size == 0;
                    }
                    size_of_list() {
                        return this.size;
                    }
                    printList() {
                        var curr = this.head;
                        var str = "";
                        while (curr) {
                            str += curr.element + " ";
                            curr = curr.next;
                        }
                        document.write(str,"<br>");
                    }
                    RevprintList() {
                        var curr = this.tail;
                        var str = "";
                        while (curr) {
                            str += curr.element + " ";
                            curr = curr.prev;
                        }
                        document.write(str,"<br>");
                    }

                }

                
                let ll=new DLinkedList()
                ll.add(5)
                ll.add(10)
                ll.printList()
                ll.addAtBeginning(3)
                ll.printList()
                ll.addAtEnd(15)
                ll.printList()
                ll.insertAt(7,2)
                ll.printList()
                //ll.removeFrom(0)
                ll.removeFrom(2)
                document.write(ll.search(10),"<br>")
                document.write("Is list empty  ",ll.isEmpty(),"<br>")
                document.write("Size of list  ",ll.size_of_list(),"<br>")
                ll.printList()
                ll.RevprintList()
                    
                    
                   
                        
        </script>
    </body>
</html>